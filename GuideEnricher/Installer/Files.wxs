<?xml version="1.0"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
   <Fragment>
      <DirectoryRef Id="TARGETDIR">
         <Directory Id="ProgramFilesFolder" Name="PFiles">
            <Directory Id="INSTALLDIR" Name="Guide Enricher">
               <Component Id="License" Guid="16ED3327-230C-4A7B-A593-6684E27D71FF" DiskId="1">
                  <File Id="LicenseFile" Name="license.rtf" Source="license.rtf"/>
               </Component>
               
               <Component Id="ServiceExe" Guid="BB06A3CF-236E-4612-B23D-671210C4270D">
                  <File Id="ServiceExe" Name="GuideEnricherService.exe" Source="..\GuideEnricher\bin\Release\GuideEnricherService.exe" KeyPath="yes"/>
                  <ServiceInstall Id="ServiceExeInstall"
                                  Name="GuideEnricher" 
                                  Description="Service to add series and episode information to your ForTheRecord guide data."
                                  ErrorControl="normal"
                                  Start="auto" 
                                  Type="ownProcess">
                     <ServiceDependency Group="no" Id="ForTheRecordServices" />
                  </ServiceInstall>
                  <ServiceControl Id="ServiceExeStart" 
                                  Name="GuideEnricher"
                                  Stop="both" 
                                  Remove="uninstall" 
                                  Wait="yes" />
               
               </Component>
               <Component Id="ServiceExeConfig" Guid="8A85871A-BAA0-424F-bFAA-D1CB576D8F74" KeyPath="yes" NeverOverwrite="yes" Permanent="yes">
                  <File Id="ServiceExeConfig" Name="GuideEnricherService.exe.config" Source="..\GuideEnricher\bin\Release\GuideEnricherService.exe.config"/>
               </Component>
               <Component Id="ServiceExeConfigExample" Guid="38f6CFCB-F8AE-44DD-8A44-AFF018F507F3" KeyPath="yes">
                  <File Id="ServiceExeConfigExample" Name="GuideEnricherService.exe.config.example" Source="..\GuideEnricher\bin\Release\GuideEnricherService.exe.config"/>
               </Component>
               <Component Id="Tvdblibdll" Guid="0A2F94ED-4D4E-4E3B-82BE-4B936C96F6F7" KeyPath="yes">
                  <File Id="Tvdblibdll" Name="TvdbLib.dll" Source="..\GuideEnricher\bin\Release\TvdbLib.dll"/>
               </Component>
               <Component Id="ftrdllclient" Guid="68699CF2-2A86-4606-B1A6-4C2EF91A6DB1" KeyPath="yes">
                  <File Id="ftrdllclient" Name="ForTheRecord.Client.Common.dll" Source="..\GuideEnricher\bin\Release\ForTheRecord.Client.Common.dll"/>
               </Component>
               <Component Id="ftrdllcommon" Guid="6606920D-6497-4430-BD0D-89E5D5013DE7" KeyPath="yes">
                  <File Id="ftrdllcommon" Name="ForTheRecord.Common.dll" Source="..\GuideEnricher\bin\Release\ForTheRecord.Common.dll"/>
               </Component>
               <Component Id="ftrdllentities" Guid="5B049237-70E2-475C-8CBA-9B53C2DAA089" KeyPath="yes">
                  <File Id="ftrdllentities" Name="ForTheRecord.Entities.dll" Source="..\GuideEnricher\bin\Release\ForTheRecord.Entities.dll"/>
               </Component>
               <Component Id="ftrdllserviceagents" Guid="5B07DDCD-8DB5-44EB-BAEB-FABB632B8F4A" KeyPath="yes">
                  <File Id="ftrdllserviceagents" Name="ForTheRecord.ServiceAgents.dll" Source="..\GuideEnricher\bin\Release\ForTheRecord.ServiceAgents.dll"/>
               </Component>
               <Component Id="ftrdllservicecontracts" Guid="812DA23C-4FC0-4F8A-AD39-89EA0BBF9E48" KeyPath="yes">
                  <File Id="ftrdllservicecontracts" Name="ForTheRecord.ServiceContracts.dll" Source="..\GuideEnricher\bin\Release\ForTheRecord.ServiceContracts.dll"/>
               </Component>
              <Component Id="log4net" Guid="1E687561-415B-4A91-82C9-D4BC9D440278" KeyPath="yes">
                <File Id="log4netdll" Name="log4net.dll" Source="..\GuideEnricher\bin\Release\log4net.dll"/>
                <File Id="log4netlicense" Name="log4net_license.txt" Source="..\GuideEnricher\References\log4net\license.txt"/>
              </Component>

            </Directory>
         </Directory>
      </DirectoryRef>
   </Fragment>
</Wix>
